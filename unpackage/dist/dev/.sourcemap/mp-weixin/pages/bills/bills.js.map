{"version":3,"file":"bills.js","sources":["pages/bills/bills.vue","D:/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYmlsbHMvYmlsbHMudnVl"],"sourcesContent":["<template>\n  <view class=\"bills-container\">\n    <!-- 月份切换 -->\n    <view class=\"month-picker\">\n      <view class=\"arrow\" @click=\"changeMonth(-1)\">◀</view>\n      <text class=\"current-month\">{{ currentMonth }}</text>\n      <view class=\"arrow\" @click=\"changeMonth(1)\">▶</view>\n    </view>\n\n    <!-- 支出收入预览 -->\n    <view class=\"summary\">\n      <view class=\"income-section\">\n        <text>总收入</text>\n        <text class=\"income\">￥{{ totalIncome }}</text>\n      </view>\n      <view class=\"expense-section\">\n        <text>总支出</text>\n        <text class=\"expense\">￥{{ totalExpense }}</text>\n      </view>\n      <view class=\"budget-section\">\n        <text>预算</text>\n        <text class=\"budget\">￥{{ budget }}</text>\n      </view>\n      <view class=\"balance-section\">\n        <text>结余</text>\n        <text :class=\"['balance', { 'positive': balance >= 0, 'negative': balance < 0 }]\">\n          ￥{{ balance }}\n        </text>\n      </view>\n    </view>\n\n    <!-- 账单列表 -->\n    <scroll-view class=\"bill-list\" scroll-y>\n      <!-- 空状态提示 -->\n      <view v-if=\"Object.keys(groupedBills).length === 0\" class=\"no-bills\">\n        本月无账单\n      </view>\n\n      <view v-for=\"(group, date) in groupedBills\" :key=\"date\">\n        <!-- 日期分隔线 -->\n        <view class=\"date-divider\">\n          <text>{{ formatDate(date) }}</text>\n        </view>\n\n        <!-- 账单项 -->\n        <view v-for=\"(item, index) in group\" :key=\"index\" class=\"bill-item\">\n          <view class=\"left\">\n            <image :src=\"getCategoryColor(item.category)\" class=\"category-color\">\t\t\t\t\r\n\t\t\t</image>\n            <view class=\"info\">\n              <text class=\"category\">{{ item.category }}</text>\n              <text class=\"remark\" v-if=\"item.remark\">{{ item.remark }}</text>\n            </view>\n          </view>\n          <view :class=\"['amount', item.type === '收入' ? 'income' : 'expense']\">\n            {{ item.type === '收入' ? '+' : '-' }}{{ item.amount }}\n          </view>\n        </view>\n      </view>\n    </scroll-view>\n\n    <!-- 底部导航栏 -->\n    <view class=\"navigation-bar\">\n      \n     \n      <IconButton \n        class=\"nav-btn\" \r\n\t\ticonSrc=\"/static/statisticsBtn.png\"\r\n\t\tlabel=\"统计\"\n        @click=\"navigateTo('statistics')\"\n      >\n        统计\n      </IconButton>\r\n\t  \r\n\t  \r\n\t  <IconButton\r\n\t    class=\"nav-btn add-bill-btn\" \r\n\t  \t\ticonSrc=\"/static/addBill.png\"\r\n\t  \t\tlabel=\"添加\"\r\n\t    @click=\"navigateTo('addBill')\"\r\n\t  >\r\n\t    添加账单\r\n\t  </IconButton>\r\n\t  \n      <IconButton \n        class=\"nav-btn\" a\r\n\t\ticonSrc=\"/static/settingsBtn.png\"\r\n\t\tlabel=\"设置\"\n        @click=\"navigateTo('settings')\"\n      >\n        设置\n      </IconButton>\n    </view>\n  </view>\n</template>\r\n\r\n<script>\r\nimport IconButton from '@/components/IconButton/IconButton.vue';\nexport default {\n  data() {\n    return {\n      bills: [],\n      categories: [\n        { name: '购物', color: '#ff6b6b', type: '支出' ,icon:'Groceries'},\n        { name: '餐饮', color: '#48dbfb', type: '支出' ,icon:'Restaurant'},\n        { name: '交通', color: '#f368e0', type: '支出' ,icon:'Transportation'},\n        { name: '娱乐', color: '#ff9f1c', type: '支出' ,icon:'Party'},\n        { name: '健康', color: '#eb3b5a', type: '支出' ,icon:'Health'},\r\n\t\t{ name: '电子', color: '#f368e0', type: '支出' ,icon:'Electronics'},\r\n\t\t{ name: '礼物', color: '#ff9f1c', type: '支出' ,icon:'Electronics'},\r\n\t\t{ name: '起居', color: '#eb3b5a', type: '支出' ,icon:'Institute'},\r\n\t\t\n        { name: '工资', color: '#1dd1a1', type: '收入' ,icon:'Money'},\n        { name: '理财', color: '#2ecc71', type: '收入' ,icon:'Savings'}\n      ],\n      totalIncome: 0,\n      totalExpense: 0,\n      currentDate: new Date(),\n      groupedBills: {},\n      currentPage: 1,\n      pageSize: 10,\n      totalPages: 1,\n      budget: uni.getStorageSync('budget') || 0 // 从设置中获取月度预算\n    };\n  },\n  computed: {\n    currentMonth() {\r\n\t\tconst year = this.currentDate.getFullYear();\r\n\t\tconst month = this.currentDate.getMonth() + 1; // getMonth() 返回 0-11，需要 +1\r\n\t\treturn `${year}年${month}月`;\n    },\n    balance() {\n      return  Number(this.budget)+Number(this.totalIncome) - Number(this.totalExpense);\n    }\n  },\n  onShow() {\n    this.loadBills();\r\n\tthis.budget=uni.getStorageSync('budget') || 1000 ;\n  },\n  methods: {\n    loadBills() {\n      const bills = uni.getStorageSync('bills') || [];\n      this.bills = bills;\n      this.filterBillsByMonth();\n    },\n    filterBillsByMonth() {\n      const year = this.currentDate.getFullYear();\n      const month = this.currentDate.getMonth();\n      const filteredBills = this.bills.filter(bill => {\n        const billDate = new Date(bill.time);\n        return billDate.getFullYear() === year && billDate.getMonth() === month;\n      });\n\n      this.totalPages = Math.ceil(filteredBills.length / this.pageSize);\n      this.groupBillsByDate(filteredBills.slice(0, this.pageSize * this.currentPage));\n      this.calculateTotal(filteredBills);\n    },\n    groupBillsByDate(bills) {\n      const grouped = {};\n      bills.forEach(bill => {\n        const date = new Date(bill.time).toLocaleDateString();\n        if (!grouped[date]) {\n          grouped[date] = [];\n        }\n        grouped[date].push(bill);\n      });\n      this.groupedBills = grouped;\n    },\n    calculateTotal(bills) {\n      this.totalIncome = bills\n        .filter(item => item.type === '收入')\n        .reduce((sum, item) => sum + Number(item.amount), 0)\n        .toFixed(2);\n\r\n\n      this.totalExpense = bills\n        .filter(item => item.type === '支出')\n        .reduce((sum, item) => sum + Number(item.amount), 0)\n        .toFixed(2);\r\n\t\t\n    },\n    changeMonth(offset) {\n      const newDate = new Date(this.currentDate);\n      newDate.setMonth(newDate.getMonth() + offset);\n      this.currentDate = newDate;\n      this.filterBillsByMonth();\n    },\n    formatDate(dateString) {\n      const date = new Date(dateString);\r\n\t  const year = date.getFullYear();\r\n\t  const month = date.getMonth() + 1; // getMonth() 返回 0-11，需要 +1\r\n\t  const day =date.getDate();\r\n\t  return `${year}年${month}月${day}日`;\n    },\n    formatTime(timestamp) {\n      const date = new Date(timestamp);\n      return `${date.getHours()}:${date.getMinutes().toString().padStart(2, '0')}`;\n    },\n    getCategoryColor(categoryName) {\n      const category = this.categories.find(c => c.name === categoryName);\n      return `/static/typeIcons/${category ? category.icon : 'Maintenance'}.png` ;\n    },\n    navigateTo(page) {\n      uni.navigateTo({\n        url: `/pages/${page}/${page}`\n      });\n    }\n  }\n};\n</script>\r\n<style lang=\"scss\">\n.bills-container {\n  //padding: 20px;\n  background-color: #f5f5f5;\n  height: calc(100vh - 50px); /* 减去底部导航栏的高度 */\r\n  width: 100%;\n  box-sizing: border-box;\n\n  /* 月份切换 */\n  .month-picker {\r\n\twidth: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background-color: #7bc7cf;\n    //border-radius: 0px;\n    //margin-bottom: 20px;\r\n\tpadding: 7px 0;\n\n    .arrow {\n      font-size: 18px;\n      color: #e8e8e8;\n      margin: 0 15px;\n    }\n\n    .current-month {\n      font-size: 16px;\n      font-weight: bold;\n      color: #ebebeb;\n    }\n  }\n\n  /* 支出收入预览 */\n  .summary {\n    display: flex;\n    justify-content: space-around;\n    background-color: #f1f1f1;\n    padding: 20px 0;\n    //border-radius: 10px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n    //margin-bottom: 20px;\n\n    .income-section,\n    .expense-section,\n    .budget-section,\n    .balance-section {\n      text-align: center;\n\n      text {\n        display: block;\n        font-size: 14px;\n        color: #666;\n      }\n\n      .income,\n      .expense,\n      .budget,\n      .balance {\n        font-size: 18px;\n        font-weight: bold;\n        margin-top: 5px;\n      }\n\n      .income {\n        color: #67d1c1;\n      }\n\n      .expense {\n        color: #ffc595;\n      }\n\n      .budget {\n        color: #8d8d8d;\n      }\n\n      .balance {\n        &.positive {\n          color: #3d3d3d;\n        }\n\n        &.negative {\n          color: #ffc595;\n        }\n      }\n    }\n  }\n\n  /* 账单列表 */\n  .bill-list {\n    height: calc(100% - 150px); /* 减去顶部和底部模块的高度 */\n    overflow-y: auto;\n    //padding: 10px 0;\r\n\twidth: 100%;\n\n    .no-bills {\n      text-align: center;\n      font-size: 20px;\n      color: #999;\n      padding: 20px;\n      background-color: #ffffff;\n      border-radius: 10px;\n      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n      margin-bottom: 20px;\n    }\n\n    .date-divider {\n      padding: 10px 25px;\n      font-size: 14px;\r\n\t  font-weight: bold;\r\n\t  \n      color: #666;\n      border-bottom: 1px solid #e0e0e0;\n      margin-bottom: 10px;\n    }\n\n    .bill-item {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      background-color: #f8f8f8;\n      padding: 15px 25px;\n      border-radius: 5px;\n      margin-bottom: 10px;\n      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\r\n\t  height: 30px;\n\n      .left {\n        display: flex;\n        align-items: center;\n\n        .category-color {\n          width: 35px;\n          height: 35px;\n          margin-right: 10px;\n        }\n\n        .info {\n          .category {\n            display: block;\n            font-size: 16px;\n            color: #282828;\n            margin-bottom: 5px;\n          }\n\n          .remark {\n            font-size: 12px;\n            color: #848484;\n            margin-top: 3px;\n          }\n        }\n      }\n\n      .amount {\n        font-size: 18px;\n\n        &.income {\n          color: #7bc7cf;\n        }\n\n        &.expense {\n          color: #ffc595;\n        }\n      }\n    }\n  }\n\n  /* 底部导航栏 */\n  .navigation-bar {\n    width: 100%;\r\n\theight: 50px;\n    display: flex;\n    justify-content: center;\r\n\t//box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);\n    background-color: rgba(255, 255, 255, 1.0); /* 半透明背景 */\n    backdrop-filter: blur(10px); /* 模糊效果 */\n    padding: 10px;\n    //z-index: 1000;\r\n\tmargin-bottom: 0;\n    //border-top: 1px solid #e0e0e0;\n\n    .nav-btn {\n      font-size: 14px;\r\n\t  //background-color:transparent;\r\n\t\tpadding: 0px 40px 10px 20px;\r\n\t  // border:none; \r\n\t  \r\n\t  &.add-bill-btn {\r\n\t  \ttransform: scale(1.2);\r\n\t\tfont-weight: bold;\r\n\t  //   font-size: 16px;\r\n\t  //   font-weight: bold;\r\n\t  //   color: #ffffff;\r\n\t  //   background-color: #7bc7cf;\r\n\t  //   border-radius: 20px;\r\n\t   padding: 0px 40px 20px 20px;\r\n\t  \r\n\t  //   &:active {\r\n\t  //     background-color: #92c7cf;\r\n\t  //     transform: scale(0.98);\r\n\t  //   }\r\n\t  }\n    }\r\n\t\n  }\n}\n</style>","import MiniProgramPage from 'E:/HBuilderProjects/BillRecord/pages/bills/bills.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":"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"}