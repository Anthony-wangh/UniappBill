{"version":3,"names":["PieChart","_sfc_main","components","data","chartData","bills","categories","name","color","type","currentDate","Date","onShow","loadBills","$refs","pieChart","drawCharts","computed","currentMonth","toLocaleDateString","year","month","methods","common_vendor","index","getStorageSync","filterBillsByMonth","getFullYear","getMonth","filteredBills","filter","bill","billDate","time","grouped","forEach","category","sery","value","item","reduce","sum","Number","amount","toFixed","push","templateData","seriesItem","series","changeMonth","offset","newDate","setMonth","wx","createPage","MiniProgramPage"],"sources":["statistics.vue","D:/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc3RhdGlzdGljcy9zdGF0aXN0aWNzLnZ1ZQ"],"sourcesContent":["<template>\t\t\r\n\t<view class=\"statistics-container\">\r\n\t\t<!-- 月份切换 -->\r\n\t\t<view class=\"month-picker\">\r\n\t\t  <view class=\"arrow\" @click=\"changeMonth(-1)\">◀</view>\r\n\t\t  <text class=\"current-month\">{{ currentMonth }}</text>\r\n\t\t  <view class=\"arrow\" @click=\"changeMonth(1)\">▶</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<PieChart\r\n\t\t\tref=\"pieChart\"\r\n\t\t\t:chartData=\"chartData\"\r\n\t\t> \r\n\t\t</PieChart>\r\n\t</view>\r\n\t\r\n\t\r\n</template>\r\n\r\n<script>\r\n\timport PieChart from '@/components/Chart/PieChart.vue';\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tPieChart,\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tchartData: {}, // 用来存储账单数据\r\n\t\t\t\tbills:[],\r\n\t\t\t\tcategories: [{\r\n\t\t\t\t\t\tname: '购物',\r\n\t\t\t\t\t\tcolor: '#ff6b6b',\r\n\t\t\t\t\t\ttype: 'expense'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: '餐饮',\r\n\t\t\t\t\t\tcolor: '#48dbfb',\r\n\t\t\t\t\t\ttype: 'expense'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: '交通',\r\n\t\t\t\t\t\tcolor: '#f368e0',\r\n\t\t\t\t\t\ttype: 'expense'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: '娱乐',\r\n\t\t\t\t\t\tcolor: '#ff9f1c',\r\n\t\t\t\t\t\ttype: 'expense'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: '房屋',\r\n\t\t\t\t\t\tcolor: '#eb3b5a',\r\n\t\t\t\t\t\ttype: 'expense'\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\tcurrentDate: new Date(),\r\n\t\t\t};\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\tthis.loadBills();\r\n\t\t\tthis.$refs.pieChart.drawCharts(this.chartData);\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t  currentMonth() {\r\n\t\t    return this.currentDate.toLocaleDateString('zh-CN', { year: 'numeric', month: 'long' });\r\n\t\t  }\r\n\t\t},\r\n\t\tmethods: {\r\n\r\n\t\tloadBills() {\n\t\t  const bills = uni.getStorageSync('bills') || [];\n\t\t  this.bills = bills;\n\t\t  this.filterBillsByMonth();\n\t\t},\n\t\tfilterBillsByMonth() {\n\t\t  const year = this.currentDate.getFullYear();\n\t\t  const month = this.currentDate.getMonth();\n\t\t  const filteredBills = this.bills.filter(bill => {\n\t\t\tconst billDate = new Date(bill.time);\n\t\t\treturn billDate.getFullYear() === year && billDate.getMonth() === month;\n\t\t  });\r\n\t\t  \r\n\t\t  const grouped = [];\r\n\t\t  this.categories.forEach(category => {\r\n\t\t\t  const sery = {};\r\n\t\t\t  sery.name=category.name;\r\n\t\t\t  sery.value=filteredBills\n\t\t\t\t.filter(item => item.category === category.name)\n\t\t\t\t.reduce((sum, item) => sum + Number(item.amount), 0)\n\t\t\t\t.toFixed(2);\r\n\t\t\t\tgrouped.push(sery);\n\t\t\t});\r\n\t\t  \r\n\t\t\tconst templateData=this.chartData;\r\n\t\t\tconst seriesItem={};\r\n\t\t\tseriesItem.data=grouped;\r\n\t\t\ttemplateData.series.push(seriesItem);\n\t\t\tthis.chartData=templateData;\n\t\t},\r\n\t\tchangeMonth(offset) {\n\t\t\t  const newDate = new Date(this.currentDate);\n\t\t\t  newDate.setMonth(newDate.getMonth() + offset);\n\t\t\t  this.currentDate = newDate;\n\t\t\t  this.filterBillsByMonth();\n\t\t},\r\n\t\t}\r\n\t};\r\n</script>\r\n<style lang=\"scss\">\r\n\t\r\n\t/* 月份切换 */\r\n\t.month-picker {\r\n\t\twidth: 100%;\r\n\t    display: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tbackground-color: #96C560;\r\n\t\tpadding: 5px 0;\r\n\t\r\n\t\t.arrow {\r\n\t    font-size: 18px;\r\n\t    color: #e8e8e8;\r\n\t    margin: 0 15px;\r\n\t\t}\r\n\t\r\n\t\t.current-month {\r\n\t    font-size: 16px;\r\n\t    font-weight: bold;\r\n\t    color: #ebebeb;\r\n\t  }\r\n\t}\r\n</style>","import MiniProgramPage from 'E:/HBuilderProjects/BillRecord/pages/statistics/statistics.vue'\nwx.createPage(MiniProgramPage)"],"mappings":"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","ignoreList":[]}